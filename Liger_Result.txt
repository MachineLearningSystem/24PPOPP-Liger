CUDA_VISIBLE_DEVICES=2,3 NCCL_MAX_NCHANNELS=3  CUDA_DEVICE_MAX_CONNECTIONS=2 mpirun -np 2 ./main 2 128 128 96 4 1
6 8 10000
Communication Complete from Rank: 0
Communication Complete from Rank: 1
Create pthread success! 
Create pthread success! 
Total 150 requests. 
Total 150 requests. 
request: 0, CPU_Time: 0.000000 ms, CUDA_Time: 31.595520 ms. 
request: 1, CPU_Time: 0.254000 ms, CUDA_Time: 38.634495 ms. 
request: 2, CPU_Time: 9.895000 ms, CUDA_Time: 25.282560 ms. 
request: 3, CPU_Time: 16.743000 ms, CUDA_Time: 25.663488 ms. 
request: 4, CPU_Time: 13.671000 ms, CUDA_Time: 26.660864 ms. 
request: 5, CPU_Time: 19.193001 ms, CUDA_Time: 27.096064 ms. 
request: 6, CPU_Time: 17.445000 ms, CUDA_Time: 33.267712 ms. 
request: 7, CPU_Time: 24.570999 ms, CUDA_Time: 29.816832 ms. 
request: 8, CPU_Time: 28.723000 ms, CUDA_Time: 30.470144 ms. 
request: 9, CPU_Time: 33.521999 ms, CUDA_Time: 33.187840 ms. 
request: 10, CPU_Time: 38.820000 ms, CUDA_Time: 35.354626 ms. 
request: 11, CPU_Time: 46.254002 ms, CUDA_Time: 25.275393 ms. 
request: 12, CPU_Time: 52.816002 ms, CUDA_Time: 19.782656 ms. 
request: 13, CPU_Time: 49.451000 ms, CUDA_Time: 22.201344 ms. 
request: 14, CPU_Time: 60.016998 ms, CUDA_Time: 21.048321 ms. 
request: 15, CPU_Time: 49.414001 ms, CUDA_Time: 26.999807 ms. 
request: 16, CPU_Time: 57.936001 ms, CUDA_Time: 18.759680 ms. 
request: 17, CPU_Time: 53.512001 ms, CUDA_Time: 27.395073 ms. 
request: 18, CPU_Time: 54.569000 ms, CUDA_Time: 29.759487 ms. 
request: 19, CPU_Time: 59.001999 ms, CUDA_Time: 21.953535 ms. 
request: 20, CPU_Time: 70.415001 ms, CUDA_Time: 18.559999 ms. 
request: 21, CPU_Time: 59.909000 ms, CUDA_Time: 34.277374 ms. 
request: 22, CPU_Time: 67.024002 ms, CUDA_Time: 33.673218 ms. 
request: 23, CPU_Time: 72.671997 ms, CUDA_Time: 35.023872 ms. 
request: 24, CPU_Time: 80.497002 ms, CUDA_Time: 32.103424 ms. 
request: 25, CPU_Time: 87.371002 ms, CUDA_Time: 24.608768 ms. 
request: 26, CPU_Time: 91.445000 ms, CUDA_Time: 25.430016 ms. 
request: 27, CPU_Time: 90.856003 ms, CUDA_Time: 30.626816 ms. 
request: 28, CPU_Time: 95.452003 ms, CUDA_Time: 31.404032 ms. 
request: 29, CPU_Time: 99.351997 ms, CUDA_Time: 25.591808 ms. 
request: 30, CPU_Time: 104.750999 ms, CUDA_Time: 19.066879 ms. 
request: 31, CPU_Time: 112.711998 ms, CUDA_Time: 21.211136 ms. 
request: 32, CPU_Time: 102.344002 ms, CUDA_Time: 38.363136 ms. 
request: 33, CPU_Time: 111.838997 ms, CUDA_Time: 32.904194 ms. 
request: 34, CPU_Time: 118.752998 ms, CUDA_Time: 24.084480 ms. 
request: 35, CPU_Time: 122.332001 ms, CUDA_Time: 27.517952 ms. 
request: 36, CPU_Time: 120.875999 ms, CUDA_Time: 25.023487 ms. 
request: 37, CPU_Time: 134.505005 ms, CUDA_Time: 20.859903 ms. 
request: 38, CPU_Time: 123.921997 ms, CUDA_Time: 34.820095 ms. 
request: 39, CPU_Time: 132.755997 ms, CUDA_Time: 29.714432 ms. 
request: 40, CPU_Time: 137.082993 ms, CUDA_Time: 30.721024 ms. 
request: 41, CPU_Time: 141.548996 ms, CUDA_Time: 33.945599 ms. 
request: 42, CPU_Time: 147.313995 ms, CUDA_Time: 25.806849 ms. 
request: 43, CPU_Time: 154.270004 ms, CUDA_Time: 19.648512 ms. 
request: 44, CPU_Time: 152.007996 ms, CUDA_Time: 25.789440 ms. 
request: 45, CPU_Time: 151.904007 ms, CUDA_Time: 32.855042 ms. 
request: 46, CPU_Time: 156.632996 ms, CUDA_Time: 23.913471 ms. 
request: 47, CPU_Time: 163.632004 ms, CUDA_Time: 18.350080 ms. 
request: 48, CPU_Time: 158.744995 ms, CUDA_Time: 21.775360 ms. 
request: 49, CPU_Time: 158.929001 ms, CUDA_Time: 19.705856 ms. 
request: 50, CPU_Time: 157.847000 ms, CUDA_Time: 26.616833 ms. 
request: 51, CPU_Time: 156.399994 ms, CUDA_Time: 33.604607 ms. 
request: 52, CPU_Time: 163.304993 ms, CUDA_Time: 22.575104 ms. 
request: 53, CPU_Time: 166.772003 ms, CUDA_Time: 19.390465 ms. 
request: 54, CPU_Time: 163.770996 ms, CUDA_Time: 31.570944 ms. 
request: 55, CPU_Time: 163.863007 ms, CUDA_Time: 28.080128 ms. 
request: 56, CPU_Time: 172.559006 ms, CUDA_Time: 20.001793 ms. 
request: 57, CPU_Time: 169.151001 ms, CUDA_Time: 30.564352 ms. 
request: 58, CPU_Time: 170.863998 ms, CUDA_Time: 32.728065 ms. 
request: 59, CPU_Time: 178.138000 ms, CUDA_Time: 23.660543 ms. 
request: 60, CPU_Time: 181.710999 ms, CUDA_Time: 35.486721 ms. 
request: 61, CPU_Time: 180.076004 ms, CUDA_Time: 34.206718 ms. 
request: 62, CPU_Time: 202.895996 ms, CUDA_Time: 12.231680 ms. 
request: 63, CPU_Time: 191.768997 ms, CUDA_Time: 27.717632 ms. 
request: 64, CPU_Time: 192.598999 ms, CUDA_Time: 23.972864 ms. 
request: 65, CPU_Time: 196.106995 ms, CUDA_Time: 18.653185 ms. 
request: 66, CPU_Time: 203.768997 ms, CUDA_Time: 17.641472 ms. 
request: 67, CPU_Time: 193.169006 ms, CUDA_Time: 27.213823 ms. 
request: 68, CPU_Time: 199.005005 ms, CUDA_Time: 20.200447 ms. 
request: 69, CPU_Time: 198.365997 ms, CUDA_Time: 19.674112 ms. 
request: 70, CPU_Time: 197.363998 ms, CUDA_Time: 26.713087 ms. 
request: 71, CPU_Time: 195.746994 ms, CUDA_Time: 33.295361 ms. 
request: 72, CPU_Time: 202.578003 ms, CUDA_Time: 24.289280 ms. 
request: 73, CPU_Time: 206.608002 ms, CUDA_Time: 20.005888 ms. 
request: 74, CPU_Time: 204.723999 ms, CUDA_Time: 21.419008 ms. 
request: 75, CPU_Time: 204.751007 ms, CUDA_Time: 26.984447 ms. 
request: 76, CPU_Time: 203.214005 ms, CUDA_Time: 25.713663 ms. 
request: 77, CPU_Time: 217.309006 ms, CUDA_Time: 12.206080 ms. 
request: 78, CPU_Time: 206.298996 ms, CUDA_Time: 20.596737 ms. 
request: 79, CPU_Time: 206.914001 ms, CUDA_Time: 19.598335 ms. 
request: 80, CPU_Time: 203.925003 ms, CUDA_Time: 20.478975 ms. 
request: 81, CPU_Time: 212.798996 ms, CUDA_Time: 11.631616 ms. 
request: 82, CPU_Time: 201.804001 ms, CUDA_Time: 21.542912 ms. 
request: 83, CPU_Time: 201.000000 ms, CUDA_Time: 31.169537 ms. 
request: 84, CPU_Time: 200.479996 ms, CUDA_Time: 38.657024 ms. 
request: 85, CPU_Time: 210.141998 ms, CUDA_Time: 25.221121 ms. 
request: 86, CPU_Time: 216.750000 ms, CUDA_Time: 25.801727 ms. 
request: 87, CPU_Time: 213.641998 ms, CUDA_Time: 35.843071 ms. 
request: 88, CPU_Time: 220.585007 ms, CUDA_Time: 32.831490 ms. 
request: 89, CPU_Time: 227.578995 ms, CUDA_Time: 24.450048 ms. 
request: 90, CPU_Time: 231.283005 ms, CUDA_Time: 29.447168 ms. 
request: 91, CPU_Time: 230.246994 ms, CUDA_Time: 35.241985 ms. 
request: 92, CPU_Time: 239.207001 ms, CUDA_Time: 32.551937 ms. 
request: 93, CPU_Time: 243.863007 ms, CUDA_Time: 35.164162 ms. 
request: 94, CPU_Time: 251.242996 ms, CUDA_Time: 27.207680 ms. 
request: 95, CPU_Time: 257.734985 ms, CUDA_Time: 26.025984 ms. 
request: 96, CPU_Time: 257.597992 ms, CUDA_Time: 22.203392 ms. 
request: 97, CPU_Time: 267.886993 ms, CUDA_Time: 12.704768 ms. 
request: 98, CPU_Time: 256.675995 ms, CUDA_Time: 22.358015 ms. 
request: 99, CPU_Time: 257.760010 ms, CUDA_Time: 19.685375 ms. 
request: 100, CPU_Time: 256.912994 ms, CUDA_Time: 21.137407 ms. 
request: 101, CPU_Time: 255.169006 ms, CUDA_Time: 28.434431 ms. 
request: 102, CPU_Time: 256.381989 ms, CUDA_Time: 24.341503 ms. 
request: 103, CPU_Time: 260.174988 ms, CUDA_Time: 20.174849 ms. 
request: 104, CPU_Time: 259.498993 ms, CUDA_Time: 18.491392 ms. 
request: 105, CPU_Time: 258.605011 ms, CUDA_Time: 19.097601 ms. 
request: 106, CPU_Time: 255.690002 ms, CUDA_Time: 29.001728 ms. 
request: 107, CPU_Time: 255.436005 ms, CUDA_Time: 27.266048 ms. 
request: 108, CPU_Time: 261.487000 ms, CUDA_Time: 20.207617 ms. 
request: 109, CPU_Time: 259.450989 ms, CUDA_Time: 22.402048 ms. 
request: 110, CPU_Time: 259.821991 ms, CUDA_Time: 20.208639 ms. 
request: 111, CPU_Time: 259.125000 ms, CUDA_Time: 19.801088 ms. 
request: 112, CPU_Time: 257.920990 ms, CUDA_Time: 18.387968 ms. 
request: 113, CPU_Time: 256.854004 ms, CUDA_Time: 17.829887 ms. 
request: 114, CPU_Time: 263.691986 ms, CUDA_Time: 20.916224 ms. 
request: 115, CPU_Time: 253.085999 ms, CUDA_Time: 35.270657 ms. 
request: 116, CPU_Time: 262.265991 ms, CUDA_Time: 24.380417 ms. 
request: 117, CPU_Time: 275.824005 ms, CUDA_Time: 18.132992 ms. 
request: 118, CPU_Time: 265.174988 ms, CUDA_Time: 26.899456 ms. 
request: 119, CPU_Time: 270.523010 ms, CUDA_Time: 18.320383 ms. 
request: 120, CPU_Time: 277.884003 ms, CUDA_Time: 12.264448 ms. 
request: 121, CPU_Time: 266.845001 ms, CUDA_Time: 27.062271 ms. 
request: 122, CPU_Time: 267.921997 ms, CUDA_Time: 29.735935 ms. 
request: 123, CPU_Time: 270.608002 ms, CUDA_Time: 32.857086 ms. 
request: 124, CPU_Time: 276.584991 ms, CUDA_Time: 23.894016 ms. 
request: 125, CPU_Time: 280.209015 ms, CUDA_Time: 29.211649 ms. 
request: 126, CPU_Time: 278.713989 ms, CUDA_Time: 35.309566 ms. 
request: 127, CPU_Time: 287.750000 ms, CUDA_Time: 32.745472 ms. 
request: 128, CPU_Time: 292.605988 ms, CUDA_Time: 32.537601 ms. 
request: 129, CPU_Time: 299.537994 ms, CUDA_Time: 33.039360 ms. 
request: 130, CPU_Time: 304.704010 ms, CUDA_Time: 24.802303 ms. 
Total_Duration: 1816.594011 ms. 
Throughput: 72.112976 samples/s. 
Average Latency: 199.714066 ms. 
Total 131 records. 