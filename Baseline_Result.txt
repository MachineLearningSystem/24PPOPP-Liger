CUDA_VISIBLE_DEVICES=2,3 NCCL_MAX_NCHANNELS=3  CUDA_DEVICE_MAX_CONNECTIONS=2 mpirun -np 2 ./main 2 128 128 96 4 16 8 10000
Communication Complete from Rank: 0
Communication Complete from Rank: 1
Create pthread success! 
Create pthread success! 
Total 150 requests. 
Total 150 requests. 
request: 0, CPU_Time: 0.000000 ms, CUDA_Time: 20.594688 ms. 
request: 1, CPU_Time: 8.901000 ms, CUDA_Time: 20.880384 ms. 
request: 2, CPU_Time: 17.905001 ms, CUDA_Time: 11.702272 ms. 
request: 3, CPU_Time: 17.871000 ms, CUDA_Time: 18.159616 ms. 
request: 4, CPU_Time: 24.198999 ms, CUDA_Time: 11.484160 ms. 
request: 5, CPU_Time: 23.933001 ms, CUDA_Time: 18.586624 ms. 
request: 6, CPU_Time: 30.875999 ms, CUDA_Time: 17.403904 ms. 
request: 7, CPU_Time: 36.580002 ms, CUDA_Time: 17.741823 ms. 
request: 8, CPU_Time: 42.874001 ms, CUDA_Time: 18.122751 ms. 
request: 9, CPU_Time: 48.998001 ms, CUDA_Time: 20.749311 ms. 
request: 10, CPU_Time: 57.625000 ms, CUDA_Time: 20.557823 ms. 
request: 11, CPU_Time: 66.508003 ms, CUDA_Time: 11.854848 ms. 
request: 12, CPU_Time: 66.573997 ms, CUDA_Time: 12.251136 ms. 
request: 13, CPU_Time: 67.102997 ms, CUDA_Time: 11.715584 ms. 
request: 14, CPU_Time: 66.875999 ms, CUDA_Time: 20.480000 ms. 
request: 15, CPU_Time: 75.636002 ms, CUDA_Time: 10.327040 ms. 
request: 16, CPU_Time: 74.288002 ms, CUDA_Time: 11.784192 ms. 
request: 17, CPU_Time: 73.975998 ms, CUDA_Time: 17.665024 ms. 
request: 18, CPU_Time: 79.824997 ms, CUDA_Time: 17.193983 ms. 
request: 19, CPU_Time: 85.112999 ms, CUDA_Time: 10.101760 ms. 
request: 20, CPU_Time: 83.321999 ms, CUDA_Time: 18.408447 ms. 
request: 21, CPU_Time: 89.942001 ms, CUDA_Time: 18.533377 ms. 
request: 22, CPU_Time: 96.660004 ms, CUDA_Time: 20.687872 ms. 
request: 23, CPU_Time: 105.670998 ms, CUDA_Time: 20.572161 ms. 
request: 24, CPU_Time: 114.642998 ms, CUDA_Time: 17.352703 ms. 
request: 25, CPU_Time: 120.099998 ms, CUDA_Time: 11.672576 ms. 
request: 26, CPU_Time: 120.014999 ms, CUDA_Time: 17.639423 ms. 
request: 27, CPU_Time: 125.981003 ms, CUDA_Time: 18.406401 ms. 
request: 28, CPU_Time: 132.647995 ms, CUDA_Time: 17.921024 ms. 
request: 29, CPU_Time: 138.841995 ms, CUDA_Time: 10.213376 ms. 
request: 30, CPU_Time: 137.214005 ms, CUDA_Time: 11.473920 ms. 
request: 31, CPU_Time: 137.061005 ms, CUDA_Time: 20.637695 ms. 
request: 32, CPU_Time: 145.940994 ms, CUDA_Time: 20.714497 ms. 
request: 33, CPU_Time: 154.854004 ms, CUDA_Time: 18.164736 ms. 
request: 34, CPU_Time: 161.360001 ms, CUDA_Time: 11.789312 ms. 
request: 35, CPU_Time: 161.649002 ms, CUDA_Time: 18.518017 ms. 
request: 36, CPU_Time: 169.070007 ms, CUDA_Time: 9.967616 ms. 
request: 37, CPU_Time: 167.399994 ms, CUDA_Time: 20.616192 ms. 
request: 38, CPU_Time: 176.363007 ms, CUDA_Time: 17.250303 ms. 
request: 39, CPU_Time: 180.962006 ms, CUDA_Time: 17.384447 ms. 
request: 40, CPU_Time: 186.597000 ms, CUDA_Time: 18.585600 ms. 
request: 41, CPU_Time: 193.552994 ms, CUDA_Time: 20.639744 ms. 
request: 42, CPU_Time: 202.309006 ms, CUDA_Time: 12.175360 ms. 
request: 43, CPU_Time: 202.548004 ms, CUDA_Time: 11.954176 ms. 
request: 44, CPU_Time: 202.647995 ms, CUDA_Time: 17.419264 ms. 
request: 45, CPU_Time: 208.145004 ms, CUDA_Time: 20.699137 ms. 
request: 46, CPU_Time: 217.070007 ms, CUDA_Time: 10.131456 ms. 
request: 47, CPU_Time: 215.341003 ms, CUDA_Time: 11.714560 ms. 
request: 48, CPU_Time: 215.335999 ms, CUDA_Time: 11.552768 ms. 
request: 49, CPU_Time: 215.007996 ms, CUDA_Time: 11.645952 ms. 
request: 50, CPU_Time: 214.897995 ms, CUDA_Time: 18.140160 ms. 
request: 51, CPU_Time: 221.251999 ms, CUDA_Time: 17.937408 ms. 
request: 52, CPU_Time: 227.304001 ms, CUDA_Time: 10.161152 ms. 
request: 53, CPU_Time: 225.688004 ms, CUDA_Time: 11.974656 ms. 
request: 54, CPU_Time: 225.960999 ms, CUDA_Time: 20.771839 ms. 
request: 55, CPU_Time: 234.923996 ms, CUDA_Time: 11.556864 ms. 
request: 56, CPU_Time: 234.697998 ms, CUDA_Time: 12.262400 ms. 
request: 57, CPU_Time: 234.837997 ms, CUDA_Time: 20.715521 ms. 
request: 58, CPU_Time: 243.863998 ms, CUDA_Time: 17.693695 ms. 
request: 59, CPU_Time: 249.223999 ms, CUDA_Time: 11.572224 ms. 
request: 60, CPU_Time: 248.925995 ms, CUDA_Time: 17.205248 ms. 
request: 61, CPU_Time: 254.352005 ms, CUDA_Time: 20.961281 ms. 
request: 62, CPU_Time: 263.598999 ms, CUDA_Time: 11.796480 ms. 
request: 63, CPU_Time: 263.714996 ms, CUDA_Time: 17.723392 ms. 
request: 64, CPU_Time: 269.700989 ms, CUDA_Time: 11.744256 ms. 
request: 65, CPU_Time: 269.634003 ms, CUDA_Time: 10.403840 ms. 
request: 66, CPU_Time: 268.312988 ms, CUDA_Time: 17.415169 ms. 
request: 67, CPU_Time: 273.859009 ms, CUDA_Time: 11.842560 ms. 
request: 68, CPU_Time: 273.855011 ms, CUDA_Time: 11.650048 ms. 
request: 69, CPU_Time: 273.835999 ms, CUDA_Time: 11.580416 ms. 
request: 70, CPU_Time: 273.606995 ms, CUDA_Time: 18.376703 ms. 
request: 71, CPU_Time: 280.272003 ms, CUDA_Time: 17.545216 ms. 
request: 72, CPU_Time: 286.147003 ms, CUDA_Time: 11.535360 ms. 
request: 73, CPU_Time: 285.707001 ms, CUDA_Time: 11.566080 ms. 
request: 74, CPU_Time: 285.317993 ms, CUDA_Time: 11.574272 ms. 
request: 75, CPU_Time: 285.148987 ms, CUDA_Time: 18.444288 ms. 
request: 76, CPU_Time: 291.833008 ms, CUDA_Time: 9.986048 ms. 
request: 77, CPU_Time: 290.157990 ms, CUDA_Time: 11.938816 ms. 
request: 78, CPU_Time: 290.441010 ms, CUDA_Time: 10.135552 ms. 
request: 79, CPU_Time: 288.838989 ms, CUDA_Time: 11.968512 ms. 
request: 80, CPU_Time: 289.135986 ms, CUDA_Time: 10.004480 ms. 
request: 81, CPU_Time: 287.303009 ms, CUDA_Time: 11.552768 ms. 
request: 82, CPU_Time: 287.000000 ms, CUDA_Time: 11.561984 ms. 
request: 83, CPU_Time: 286.808990 ms, CUDA_Time: 20.726784 ms. 
request: 84, CPU_Time: 295.782990 ms, CUDA_Time: 20.773888 ms. 
request: 85, CPU_Time: 304.881989 ms, CUDA_Time: 11.722752 ms. 
request: 86, CPU_Time: 304.847992 ms, CUDA_Time: 18.167809 ms. 
request: 87, CPU_Time: 311.270996 ms, CUDA_Time: 20.564993 ms. 
request: 88, CPU_Time: 320.075012 ms, CUDA_Time: 18.208769 ms. 
request: 89, CPU_Time: 326.210999 ms, CUDA_Time: 12.186624 ms. 
request: 90, CPU_Time: 326.625000 ms, CUDA_Time: 20.593664 ms. 
request: 91, CPU_Time: 335.558990 ms, CUDA_Time: 17.369087 ms. 
request: 92, CPU_Time: 340.921997 ms, CUDA_Time: 20.666368 ms. 
request: 93, CPU_Time: 349.687012 ms, CUDA_Time: 20.498432 ms. 
request: 94, CPU_Time: 358.545990 ms, CUDA_Time: 12.086272 ms. 
request: 95, CPU_Time: 358.890015 ms, CUDA_Time: 17.684481 ms. 
request: 96, CPU_Time: 364.691986 ms, CUDA_Time: 9.999360 ms. 
request: 97, CPU_Time: 363.001007 ms, CUDA_Time: 12.324864 ms. 
request: 98, CPU_Time: 363.330994 ms, CUDA_Time: 11.660288 ms. 
request: 99, CPU_Time: 362.915985 ms, CUDA_Time: 11.544576 ms. 
request: 100, CPU_Time: 362.692993 ms, CUDA_Time: 12.260352 ms. 
request: 101, CPU_Time: 363.002014 ms, CUDA_Time: 17.968128 ms. 
request: 102, CPU_Time: 369.003998 ms, CUDA_Time: 11.960320 ms. 
request: 103, CPU_Time: 369.192993 ms, CUDA_Time: 11.700224 ms. 
request: 104, CPU_Time: 369.186005 ms, CUDA_Time: 10.237952 ms. 
request: 105, CPU_Time: 367.631012 ms, CUDA_Time: 11.644928 ms. 
request: 106, CPU_Time: 367.636993 ms, CUDA_Time: 18.561024 ms. 
request: 107, CPU_Time: 374.339996 ms, CUDA_Time: 11.615232 ms. 
request: 108, CPU_Time: 374.187988 ms, CUDA_Time: 11.845632 ms. 
request: 109, CPU_Time: 373.862000 ms, CUDA_Time: 12.168192 ms. 
request: 110, CPU_Time: 374.141998 ms, CUDA_Time: 11.469824 ms. 
request: 111, CPU_Time: 373.885010 ms, CUDA_Time: 11.693056 ms. 
request: 112, CPU_Time: 373.756012 ms, CUDA_Time: 10.100736 ms. 
request: 113, CPU_Time: 372.072998 ms, CUDA_Time: 10.369024 ms. 
request: 114, CPU_Time: 370.628998 ms, CUDA_Time: 20.513792 ms. 
request: 115, CPU_Time: 379.154999 ms, CUDA_Time: 17.549313 ms. 
request: 116, CPU_Time: 384.858002 ms, CUDA_Time: 11.741184 ms. 
request: 117, CPU_Time: 384.933014 ms, CUDA_Time: 17.771521 ms. 
request: 118, CPU_Time: 390.876007 ms, CUDA_Time: 11.717632 ms. 
request: 119, CPU_Time: 390.791992 ms, CUDA_Time: 9.917440 ms. 
request: 120, CPU_Time: 388.872986 ms, CUDA_Time: 11.850752 ms. 
request: 121, CPU_Time: 389.050995 ms, CUDA_Time: 17.295361 ms. 
request: 122, CPU_Time: 394.368011 ms, CUDA_Time: 17.181696 ms. 
request: 123, CPU_Time: 399.578003 ms, CUDA_Time: 17.932287 ms. 
request: 124, CPU_Time: 405.882996 ms, CUDA_Time: 11.629568 ms. 
request: 125, CPU_Time: 405.584991 ms, CUDA_Time: 20.710400 ms. 
request: 126, CPU_Time: 414.510010 ms, CUDA_Time: 17.629185 ms. 
request: 127, CPU_Time: 420.122986 ms, CUDA_Time: 20.772863 ms. 
request: 128, CPU_Time: 429.147003 ms, CUDA_Time: 17.956863 ms. 
request: 129, CPU_Time: 435.401001 ms, CUDA_Time: 20.575232 ms. 
request: 130, CPU_Time: 444.286987 ms, CUDA_Time: 11.501568 ms. 
Total_Duration: 1994.485718 ms. 
Throughput: 65.681091 samples/s. 
Average Latency: 260.409698 ms. 
Total 131 records. 